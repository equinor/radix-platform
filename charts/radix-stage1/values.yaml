testing:
  clusterFQDN: "xx"
  influxDBurl: "xx"

  tests:
    - service: "grafana"
      endpoint: "/login"
      expect: 200
    - service: "api"
      endpoint: "/"
      expect: 403
    - service: "www-radix-canary-golang-prod"
      endpoint: "/"
      expect: 200
    - service: "webhook-radix-github-webhook-qa"
      endpoint: "/"
      expect: 500
    - service: "web-radix-web-console-dev"
      endpoint: "/"
      expect: 200
    - service: "public-site-radix-platform-dev"
      endpoint: "/"
      expect: 200
    - service: "server-radix-api-qa"
      endpoint: "/swaggerui/"
      expect: 200

imageCredentials:
  registry: xx
  username: xx
  password: xx

externalDns:
  enabled: true
  environment: dev
  deploymentTargetName: xx
  imageTag: "v0.5.7"

# radix-operator child chart
radix-operator:
  enabled: true
  clusterAKSAPIserver: xx
  imageCredentials:
    username: xx
    password: xx

# radix-kubernetes-api-proxy child chart
radix-kubernetes-api-proxy:
  enabled: true

  # radix-kubernetes-api-proxy chart values:
  clusterFQDN: "change-me"

radixClusterAdminGroup: "604bad73-c53b-4a95-ab17-d7953f75c8c3" # "fg_radix_platform_development"
radixUserGroup: "7552642f-ad75-4e9d-a140-3ab8f3742c16"

# kubed child chart
kubed:
  enabled: true

  # kubed chart values:
  apiserver:
    enabled: false
  config:
    clusterName: xx
  rbac:
    create: true
  enableAnalytics: false

# nginx-ingress child chart
nginx-ingress:
  enabled: true

  # nginx-ingress chart values:
  controller:
    publishService:
      enabled: true
    stats:
      enabled: true
    metrics:
      enabled: true
    service:
      enableHttp: false
    externalTrafficPolicy: "Local"

# Connected to nginx-ingress
createIngressServiceMonitor: true

# Connected to cert-manager, but cannot use cert-manager values because helm templating does not handle dashes in variable names very well
createClusterIssuer: true

clusterWildcardCert:
  enabled: true
  environment: xx
  deploymentTargetName: xx

certManagerAzureDnsSecret: xx

# kube-prometheus child chart
# Disable the grafana that is bundled with kube-prometheus via requirements.yaml
deployGrafana: false

kube-prometheus:
  enabled: true
  
  # kube-prometheus chart values
  prometheus:
    image:
      tag: v2.3.1
    retention: 31d
    # externalUrl: ""
    # routePrefix: /
    #remoteWrite:
    #- url: "https://[[influxDBUsername]]:[[influxDBPassword]]@radixinfluxdb.azurewebsites.net/api/v1/prom/write?db=influxdb"
    ingress:
      enabled: true
      hosts:
      - xx
      tls:
      - secretName: cluster-wildcard-tls-cert
        hosts:
          - xx

# grafana child chart
grafana:
  enabled: true

  # grafana chart values
  image:
    repository: grafana/grafana
    tag: latest
    pullPolicy: Always

  ingress:
    enabled: true
    hosts:
    - xx
    tls:
    - secretName: cluster-wildcard-tls-cert
      hosts:
        - xx

  datasources:
    datasources.yaml:
      apiVersion: 1
      datasources:
      - name: prometheus
        type: prometheus
        url: http://radix-stage1-prometheus:9090
        access: proxy
        isDefault: true
        basicAuth: false

  env:
    GF_AUTH_GENERIC_OAUTH_CLIENT_ID: 7542f95d-c9f4-492f-8450-b3ef2286da7c
    GF_AUTH_GENERIC_OAUTH_ENABLED: "true"
    GF_AUTH_ANONYMOUS_ENABLED: "false"
    GF_AUTH_GENERIC_OAUTH_NAME: Azure AD
    GF_AUTH_GENERIC_OAUTH_ALLOW_SIGN_UP: "true"
    GF_AUTH_GENERIC_OAUTH_SCOPES: openid email name
    GF_AUTH_GENERIC_OAUTH_AUTH_URL: https://login.microsoftonline.com/3aa4a235-b6e2-48d5-9195-7fcf05b459b0/oauth2/authorize
    GF_AUTH_GENERIC_OAUTH_TOKEN_URL: https://login.microsoftonline.com/3aa4a235-b6e2-48d5-9195-7fcf05b459b0/oauth2/token
    GF_DATABASE_TYPE: mysql
    GF_DATABASE_SSL_MODE: "skip-verify"
    GF_DATABASE_CA_CERT_PATH: /etc/ssl/certs/ca-certificates.crt
    GF_DATABASE_HOST: radix-dev-grafana.mysql.database.azure.com
    GF_DATABASE_NAME: grafana
    GF_DATABASE_USER: "mysqlAdmin@radix-dev-grafana"
    GF_USERS_AUTO_ASSIGN_ORG_ROLE: "Editor" # Viewer|Editor|Admin
    GF_SERVER_ROOT_URL: xx

  envFromSecret: grafana-secret-envs
  
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
